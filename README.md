# Тестовое задание

## Запуск через Doker

Можно ничего не менять, главное что бы на портах `8000`, `8080`, `5435`, `5436`, `5432`, `15672`, `5672` ничего не
крутилось

```commandline
 docker-compose up --build -d
```

Приложения доступны на `8000` и `8080` портах

## Локальный запуск

Установить зависимости

```commandline
poetry install
```

Внутри пакетов `bet_maker` и `line_provider` нужно настроить конфиги `conf.yaml`.

База данных для кадого сервиса должна быть своя.

Для запуска первого сервиса `bet_maker`, находясь в корне проекта, нужно прописать в терминале

```commandline
python . --name bet_maker
```

Для запуска второго сервиса `line_provider` нужно открыть второй терминал и в нём прописать

```commandline
python . --name line_provider
```

## Архитиктура проекта

В репозитории присутствуют 2 сервиса из тестового задания, а так же пакет `core` он представляет собой упращёную версию
бибилотеки, которая используется между сервисами.

Общение между сервисами организованно двумя спосабами:

* Для получения актуальных событей `bet_maker` обращается по HTTP к `line_provider`
* Когда в `line_provider` приходит запрос на смену статуса у какого-то события, он обновляет его в своей базе данных, а
  также через RabbitMQ отправляет сообщение в очередь `new_status`. Эта очередь прослушивается сервисом `bet_maker`,
  который при получении сообщения обновляет статусы у всех ставок, связанных с этим событием.

## Важные моменты

* При каждом перезапуске сервисов они пересоздают таблицы.
* Swagger докумендация по каждому из сервисов доступна по стандартому адресу `/docs`
* 
